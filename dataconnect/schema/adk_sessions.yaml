collections:
  adk_sessions:
    schema: AdkSession
    indexes:
      - fields: ["userId", "sessionId"]
        unique: true
    rules:
      read: "auth != null && auth.uid == resource.data.userId"
      write: "auth != null && auth.uid == resource.data.userId"
      
  adk_messages:
    schema: AdkMessage
    indexes:
      - fields: ["sessionId", "createdAt"]
    rules:
      read: "auth != null && auth.uid == get(/databases/$(database)/documents/adk_sessions/$(resource.data.sessionId)).data.userId"
      write: "auth != null && auth.uid == get(/databases/$(database)/documents/adk_sessions/$(resource.data.sessionId)).data.userId" 